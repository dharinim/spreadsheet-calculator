<script type="text/javascript"> 
  $(document).ready(displaySpreadsheet);

  function displaySpreadsheet(){
    var data = function () {
    return Handsontable.helper.createSpreadsheetData(100, 10);
    };
 
    var container = document.getElementById('calculator');
    // console.log(container)
      var data = [
    ["", "Ford", "Volvo", "Toyota", "Honda"],
    ["2016", 10, 11, 12, 13],
    ["2017", 20, 11, 14, 13],
    ["2018", 30, 15, 12, 13]
    ];
    console.log("getting data");
    var hot = new Handsontable(container, {
      data: data,
      minSpareCols: 1,
      minSpareRows: 1,
      rowHeaders: true,
      colHeaders: true,
      contextMenu: true
    });
    // console.log("getting data")
    // console.log(hot.countEmptyRows())
    // console.log(hot.countEmptyCols())
    // console.log(hot.countRows())
    // console.log(hot.countCols())
    // console.log(hot.getData())
    console.log(JSON.stringify(hot.getData()))
    updatespreadsheet(hot);
    
  }

  function updatespreadsheet(hot) {
    $.ajax({
      url: '/calculators',
      method: 'POST',
      dataType: "json",
      contentType: "application/json; charset=utf-8",
      data: JSON.stringify({json: hot.getData(), col_count: hot.countCols()-hot.countEmptyCols()} )
    }).done(function (){
    console.log(hot.getData())
    });
  }
  

</script>

<h2>Spreadsheet Calculator</h2>
<p>
Enter the data in spreadsheet and get the results
</p>

<div id="calculator"></div>

